<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="theme-color" content="#0b0d12">

  <title>GENESIS 1.1 - –ü–ª–∞—Ç—Ñ–æ—Ä–º–∞ –¥–ª—è –ø–∞—Å—Å–∏–≤–Ω–æ–≥–æ –∏ –∞–∫—Ç–∏–≤–Ω–æ–≥–æ –¥–æ—Ö–æ–¥–∞ –≤ –∫—Ä–∏–ø—Ç–æ–≤–∞–ª—é—Ç–µ</title>
  <meta name="description" content="–ó–∞—Ä–∞–±–∞—Ç—ã–≤–∞–π—Ç–µ –ø–∞—Å—Å–∏–≤–Ω—ã–π –∏ –∞–∫—Ç–∏–≤–Ω—ã–π –¥–æ—Ö–æ–¥ –≤ –∏–Ω—Ç–µ—Ä–Ω–µ—Ç–µ —Å GENESIS 1.1. –î–µ–ø–æ–∑–∏—Ç—ã –æ—Ç $25, –ø–∞—Ä—Ç–Ω–µ—Ä—Å–∫–∞—è –ø—Ä–æ–≥—Ä–∞–º–º–∞ 3 —É—Ä–æ–≤–Ω—è, MEV-–±–æ—Ç—ã —Å –¥–æ—Ö–æ–¥–Ω–æ—Å—Ç—å—é –¥–µ—Å—è—Ç–∫–∏ –ø—Ä–æ—Ü–µ–Ω—Ç–æ–≤ –≤ —Å—É—Ç–∫–∏.">

  <!-- Favicons -->
  <link rel="icon" href="/public/icons/icon-192.png">
  <link rel="apple-touch-icon" href="/public/icons/icon-192.png">

  <!-- PWA Manifest -->
  <link rel="manifest" href="/public/manifest.json">

  <!-- Styles -->
  <link rel="stylesheet" href="/src/styles/tokens.css">
  <link rel="stylesheet" href="/src/styles/theme-dark.css">

  <!-- Structured Data -->
  <script type="application/ld+json">
  {
    "@context": "https://schema.org",
    "@type": "WebApplication",
    "name": "GENESIS 1.1",
    "description": "–ü–ª–∞—Ç—Ñ–æ—Ä–º–∞ –¥–ª—è –ø–∞—Å—Å–∏–≤–Ω–æ–≥–æ –∏ –∞–∫—Ç–∏–≤–Ω–æ–≥–æ –¥–æ—Ö–æ–¥–∞ –≤ –∫—Ä–∏–ø—Ç–æ–≤–∞–ª—é—Ç–µ",
    "applicationCategory": "FinanceApplication"
  }
  </script>
</head>
<body>
  <!-- Main Container -->
  <main class="container">
    <!-- Hero Section -->
    <section id="hero" style="text-align: center; padding: var(--space-4xl) 0;">
      <h1 id="hero-title">GENESIS 1.1</h1>
      <p style="font-size: var(--font-size-xl); color: var(--text-muted); margin-top: var(--space-lg);">
        –ü–ª–∞—Ç—Ñ–æ—Ä–º–∞ –¥–ª—è –ø–∞—Å—Å–∏–≤–Ω–æ–≥–æ –∏ –∞–∫—Ç–∏–≤–Ω–æ–≥–æ –¥–æ—Ö–æ–¥–∞ –≤ –∫—Ä–∏–ø—Ç–æ–≤–∞–ª—é—Ç–µ
      </p>
    </section>

    <!-- Features Section -->
    <section id="features" style="padding: var(--space-4xl) 0;">
      <h2 class="section-title">–í–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏ –ø–ª–∞—Ç—Ñ–æ—Ä–º—ã</h2>

      <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: var(--space-2xl);">
        <div class="card">
          <h3 class="sub-title">–ü–∞—Å—Å–∏–≤–Ω—ã–π –¥–æ—Ö–æ–¥</h3>
          <ul class="list-bullets">
            <li>–î–æ—Ö–æ–¥ –æ—Ç –∞—Ä–µ–Ω–¥—ã –º–æ—â–Ω–æ—Å—Ç–µ–π —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞</li>
            <li>–î–æ—Ö–æ–¥ –æ—Ç –¥–µ–ø–æ–∑–∏—Ç–æ–≤ —Å –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–º–∏ –≤—ã–ø–ª–∞—Ç–∞–º–∏</li>
            <li>–ü–∞—Ä—Ç–Ω–µ—Ä—Å–∫–∞—è –ø—Ä–æ–≥—Ä–∞–º–º–∞ 3 —É—Ä–æ–≤–Ω—è (5% –æ—Ç –≤–ª–æ–∂–µ–Ω–∏–π –∏ –¥–æ—Ö–æ–¥–∞)</li>
            <li>–ü—Ä–æ–≥—Ä–∞–º–º–∞ –ª–æ—è–ª—å–Ω–æ—Å—Ç–∏ –∏ –±–æ–Ω—É—Å–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞</li>
          </ul>
        </div>

        <div class="card">
          <h3 class="sub-title">–ê–∫—Ç–∏–≤–Ω—ã–π –¥–æ—Ö–æ–¥</h3>
          <ul class="list-bullets">
            <li>MEV-–±–æ—Ç—ã —Å –¥–æ—Ö–æ–¥–Ω–æ—Å—Ç—å—é –¥–µ—Å—è—Ç–∫–∏ –ø—Ä–æ—Ü–µ–Ω—Ç–æ–≤ –≤ —Å—É—Ç–∫–∏</li>
            <li>–ê—Ä–±–∏—Ç—Ä–∞–∂–Ω—ã–µ —Ä–æ–±–æ—Ç—ã –¥–ª—è –º–≥–Ω–æ–≤–µ–Ω–Ω—ã—Ö —Å–¥–µ–ª–æ–∫</li>
            <li>–î–æ—Ö–æ–¥ –æ—Ç –≤–æ–ª–∞—Ç–∏–ª—å–Ω–æ—Å—Ç–∏ PLEX ONE —Ç–æ–∫–µ–Ω–∞</li>
            <li>–ê–∫—Ç–∏–≤–Ω—ã–µ –º–Ω–æ–∂–∏—Ç–µ–ª–∏ –¥–ª—è —É–≤–µ–ª–∏—á–µ–Ω–∏—è –ø—Ä–∏–±—ã–ª–∏</li>
          </ul>
        </div>
      </div>
    </section>

    <!-- Trust Section -->
    <section id="trust" style="padding: var(--space-4xl) 0; text-align: center;">
      <h2 class="section-title">–î–æ–≤–µ—Ä–∏–µ –∏ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å</h2>
      <div id="trust-badges" class="hidden" style="display: flex; gap: var(--space-md); justify-content: center; flex-wrap: wrap; margin-top: var(--space-xl);">
        <span class="chip chip--success">–í–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏—è: –ø–æ–¥—Ç–≤–µ—Ä–∂–¥—ë–Ω</span>
        <a id="badgeContract" class="badge" target="_blank" rel="noopener noreferrer">BscScan: Contract</a>
        <a id="badgeRead" class="badge" target="_blank" rel="noopener noreferrer">BscScan: Read</a>
        <a id="badgeWrite" class="badge" target="_blank" rel="noopener noreferrer">BscScan: Write</a>
      </div>
      <p id="trust-message" class="text-muted" style="margin-top: var(--space-lg);">
        –ê–¥—Ä–µ—Å –∫–æ–Ω—Ç—Ä–∞–∫—Ç–∞ –±—É–¥–µ—Ç –¥–æ—Å—Ç—É–ø–µ–Ω –ø–æ—Å–ª–µ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏
      </p>
    </section>

    <!-- Price Chart Section -->
    <section id="price" style="padding: var(--space-4xl) 0;">
      <h2 class="section-title">–ì—Ä–∞—Ñ–∏–∫ —Ü–µ–Ω—ã PLEX ONE</h2>
      <div id="chartWrap" class="card">
        <div id="chart" data-state="idle" style="height: 260px; background: var(--bg-1); border-radius: var(--radius-md);"></div>
        <div class="actions">
          <button id="refreshChart" class="btn btn--ghost">–û–±–Ω–æ–≤–∏—Ç—å –≥—Ä–∞—Ñ–∏–∫</button>
        </div>
      </div>
    </section>

    <!-- Auth Section with Stepper -->
    <section id="auth" style="padding: var(--space-4xl) 0;">
      <h2 class="section-title">–ê–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è –≤ —Å–∏—Å—Ç–µ–º–µ</h2>

      <ol id="auth-steps" class="stepper">
        <!-- Step 1: Wallet Address -->
        <li data-step="1" class="step is-active">
          <h3 class="sub-title">1) –í–≤–µ–¥–∏—Ç–µ –∞–¥—Ä–µ—Å –∫–æ—à–µ–ª—å–∫–∞</h3>
          <div class="field">
            <label for="userAddress">–í–∞—à –∞–¥—Ä–µ—Å –∫–æ—à–µ–ª—å–∫–∞ (BSC)</label>
            <input
              id="userAddress"
              name="userAddress"
              type="text"
              autocomplete="off"
              inputmode="text"
              placeholder="0x‚Ä¶ (42 —Å–∏–º–≤–æ–ª–∞)"
              aria-describedby="userAddressHelp">
            <p id="userAddressHelp" class="help"></p>
          </div>
          <div class="actions">
            <button id="step1Next" class="btn btn--primary" disabled>–î–∞–ª–µ–µ</button>
          </div>
        </li>

        <!-- Step 2: Payment -->
        <li data-step="2" class="step">
          <h3 class="sub-title">2) –û–ø–ª–∞—Ç–∞ / –¥–µ–ø–æ–∑–∏—Ç</h3>
          <div class="card">
            <div class="qr" id="system-qr">
              <p class="text-muted">QR-–∫–æ–¥ –ø–æ—è–≤–∏—Ç—Å—è –ø–æ—Å–ª–µ –ø–µ—Ä–≤–æ–≥–æ —à–∞–≥–∞</p>
            </div>
            <div class="addr">
              <code id="systemAddress" data-contract-address="">–ê–¥—Ä–µ—Å –¥–ª—è –æ–ø–ª–∞—Ç—ã –ø–æ—è–≤–∏—Ç—Å—è –∑–¥–µ—Å—å</code>
              <button id="copySystemAddress" class="btn btn--ghost" disabled>–°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –∞–¥—Ä–µ—Å</button>
            </div>
            <p class="note">
              –ü–µ—Ä–µ–≤–µ–¥–∏—Ç–µ —É–∫–∞–∑–∞–Ω–Ω—É—é —Å—É–º–º—É –Ω–∞ –∞–¥—Ä–µ—Å –≤—ã—à–µ. –ü–æ—Å–ª–µ –æ—Ç–ø—Ä–∞–≤–∫–∏ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏ –Ω–∞–∂–º–∏—Ç–µ ¬´–ü—Ä–æ–≤–µ—Ä–∏—Ç—å –æ–ø–ª–∞—Ç—É¬ª.
            </p>
            <div class="actions">
              <button id="checkPayment" class="btn btn--primary" data-rate-limit="15" disabled>
                –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –æ–ø–ª–∞—Ç—É
              </button>
              <span class="hint">–õ–∏–º–∏—Ç: –Ω–µ —á–∞—â–µ 1 —Ä–∞–∑–∞ –≤ 15 —Å–µ–∫ (—ç–∫–æ–Ω–æ–º–∏–º RPC)</span>
            </div>
          </div>
          <div class="actions">
            <button id="step2Back" class="btn">–ù–∞–∑–∞–¥</button>
            <button id="step2Next" class="btn btn--primary" disabled>–î–∞–ª–µ–µ</button>
          </div>
        </li>

        <!-- Step 3: Verification -->
        <li data-step="3" class="step">
          <h3 class="sub-title">3) –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏</h3>
          <div id="paymentStatus" class="chip chip--processing">–û–∂–∏–¥–∞–Ω–∏–µ –ø—Ä–æ–≤–µ—Ä–∫–∏‚Ä¶</div>
          <p class="text-muted" style="margin-top: var(--space-lg);">
            –ü—Ä–æ–≤–µ—Ä—è–µ–º –ø–æ–ª—É—á–µ–Ω–∏–µ –ø–ª–∞—Ç–µ–∂–∞ –≤ –±–ª–æ–∫—á–µ–π–Ω–µ. –≠—Ç–æ –º–æ–∂–µ—Ç –∑–∞–Ω—è—Ç—å –Ω–µ—Å–∫–æ–ª—å–∫–æ –º–∏–Ω—É—Ç.
          </p>
          <div class="actions">
            <button id="recheckPayment" class="btn btn--ghost">–ü—Ä–æ–≤–µ—Ä–∏—Ç—å –µ—â—ë —Ä–∞–∑</button>
            <button id="step3Next" class="btn btn--primary" disabled>–î–∞–ª–µ–µ</button>
          </div>
        </li>

        <!-- Step 4: Complete -->
        <li data-step="4" class="step">
          <h3 class="sub-title">4) –ì–æ—Ç–æ–≤–æ!</h3>
          <p style="font-size: var(--font-size-lg); color: var(--success);">
            ‚úÖ –ê–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∞. –î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å –≤ GENESIS 1.1!
          </p>
          <p class="text-muted" style="margin-top: var(--space-md);">
            –¢–µ–ø–µ—Ä—å –≤—ã –º–æ–∂–µ—Ç–µ –ø–µ—Ä–µ–π—Ç–∏ –≤ –ª–∏—á–Ω—ã–π –∫–∞–±–∏–Ω–µ—Ç –∏ –Ω–∞—á–∞—Ç—å –∑–∞—Ä–∞–±–∞—Ç—ã–≤–∞—Ç—å.
          </p>
          <div class="actions">
            <a href="/cabinet" class="btn btn--primary">–û—Ç–∫—Ä—ã—Ç—å –∫–∞–±–∏–Ω–µ—Ç</a>
          </div>
        </li>
      </ol>
    </section>

    <!-- Technical Info Section -->
    <section id="tech-panel" style="padding: var(--space-4xl) 0;">
      <h2 class="section-title">–¢–µ—Ö–Ω–∏—á–µ—Å–∫–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è</h2>
      <div class="card">
        <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: var(--space-lg);">
          <div>
            <div class="text-muted" style="font-size: var(--font-size-sm);">–ë—Ä–∞—É–∑–µ—Ä</div>
            <div id="tech-browser" class="skeleton" style="height: 20px; margin-top: var(--space-xs);"></div>
          </div>
          <div>
            <div class="text-muted" style="font-size: var(--font-size-sm);">–Ø–∑—ã–∫</div>
            <div id="tech-lang" class="skeleton" style="height: 20px; margin-top: var(--space-xs);"></div>
          </div>
          <div>
            <div class="text-muted" style="font-size: var(--font-size-sm);">–ß–∞—Å–æ–≤–æ–π –ø–æ—è—Å</div>
            <div id="tech-timezone" class="skeleton" style="height: 20px; margin-top: var(--space-xs);"></div>
          </div>
          <div>
            <div class="text-muted" style="font-size: var(--font-size-sm);">–°–æ–µ–¥–∏–Ω–µ–Ω–∏–µ</div>
            <div id="tech-connection" class="skeleton" style="height: 20px; margin-top: var(--space-xs);"></div>
          </div>
        </div>
      </div>
    </section>

    <!-- Footer -->
    <footer style="padding: var(--space-4xl) 0; text-align: center; border-top: 1px solid var(--border-color); margin-top: var(--space-4xl);">
      <p class="text-muted" style="font-size: var(--font-size-sm);">
        ¬© 2025 GENESIS 1.1. –í—Å–µ –ø—Ä–∞–≤–∞ –∑–∞—â–∏—â–µ–Ω—ã.
      </p>
    </footer>
  </main>

  <!-- Scripts -->
  <script type="module">
    import { isHexAddressBSC, debounce, normalizeAddress } from '/src/js/validators.js';
    import { copy, setupCopyButton } from '/src/js/clipboard.js';
    import { showToast, initStepper, setActiveStep, nextStep, prevStep, setStepState, setLoading, showSkeleton, hideSkeleton } from '/src/js/ui.js';
    import { initChart, generateMockData } from '/src/js/chart.js';
    import { initPWA } from '/src/js/pwa.js';

    // ===== GLOBALS =====
    let chart = null;
    let lastPaymentCheck = 0;
    const RATE_LIMIT_MS = 15000; // 15 —Å–µ–∫—É–Ω–¥

    // ===== INIT =====
    document.addEventListener('DOMContentLoaded', async () => {
      console.log('üöÄ GENESIS 1.1 initializing...');

      // Init PWA
      await initPWA();

      // Init Stepper
      initStepper('auth-steps');

      // Init Chart
      chart = initChart(document.getElementById('chart'));

      // Init Event Listeners
      setupEventListeners();

      // Fill Technical Info
      fillTechInfo();

      console.log('‚úÖ GENESIS 1.1 initialized');
    });

    // ===== EVENT LISTENERS =====
    function setupEventListeners() {
      // Step 1: Address validation
      const userAddressInput = document.getElementById('userAddress');
      const step1NextBtn = document.getElementById('step1Next');

      userAddressInput.addEventListener('input', debounce((e) => {
        validateAddress(e.target.value);
      }, 500));

      step1NextBtn.addEventListener('click', () => {
        const address = normalizeAddress(userAddressInput.value);
        if (isHexAddressBSC(address)) {
          proceedToPayment(address);
        }
      });

      // Step 2: Payment
      document.getElementById('step2Back').addEventListener('click', () => prevStep());
      document.getElementById('step2Next').addEventListener('click', () => nextStep());

      const checkPaymentBtn = document.getElementById('checkPayment');
      checkPaymentBtn.addEventListener('click', () => checkPayment());

      // Step 3: Verification
      document.getElementById('recheckPayment').addEventListener('click', () => recheckPayment());
      document.getElementById('step3Next').addEventListener('click', () => nextStep());

      // Chart refresh
      document.getElementById('refreshChart').addEventListener('click', () => refreshChart());

      // Copy system address
      setupCopyButton(
        document.getElementById('copySystemAddress'),
        () => document.getElementById('systemAddress').textContent
      );
    }

    // ===== ADDRESS VALIDATION =====
    function validateAddress(address) {
      const helpEl = document.getElementById('userAddressHelp');
      const inputEl = document.getElementById('userAddress');
      const nextBtn = document.getElementById('step1Next');

      if (!address || address.length === 0) {
        helpEl.textContent = '';
        helpEl.className = 'help';
        inputEl.classList.remove('is-valid', 'is-invalid');
        nextBtn.disabled = true;
        return;
      }

      const normalized = normalizeAddress(address);

      if (isHexAddressBSC(normalized)) {
        helpEl.textContent = '‚úì –ê–¥—Ä–µ—Å –∫–æ—Ä—Ä–µ–∫—Ç–µ–Ω';
        helpEl.className = 'help is-success';
        inputEl.classList.add('is-valid');
        inputEl.classList.remove('is-invalid');
        nextBtn.disabled = false;
      } else {
        helpEl.textContent = '‚úó –ù–µ–≤–µ—Ä–Ω—ã–π —Ñ–æ—Ä–º–∞—Ç –∞–¥—Ä–µ—Å–∞ (–æ–∂–∏–¥–∞–µ—Ç—Å—è 0x‚Ä¶ 42 —Å–∏–º–≤–æ–ª–∞)';
        helpEl.className = 'help is-error';
        inputEl.classList.add('is-invalid');
        inputEl.classList.remove('is-valid');
        nextBtn.disabled = true;
      }
    }

    // ===== PROCEED TO PAYMENT =====
    function proceedToPayment(userAddress) {
      // –°–∏–º—É–ª—è—Ü–∏—è: –≥–µ–Ω–µ—Ä–∏—Ä—É–µ–º —Å–∏—Å—Ç–µ–º–Ω—ã–π –∞–¥—Ä–µ—Å –¥–ª—è –æ–ø–ª–∞—Ç—ã
      const systemAddress = '0x742d35Cc6634C0532925a3b844Bc9e7595f0bEb3'; // Example address

      // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –∞–¥—Ä–µ—Å
      const systemAddressEl = document.getElementById('systemAddress');
      systemAddressEl.textContent = systemAddress;
      systemAddressEl.dataset.contractAddress = systemAddress;

      // –í–∫–ª—é—á–∞–µ–º –∫–Ω–æ–ø–∫—É –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏—è
      document.getElementById('copySystemAddress').disabled = false;
      document.getElementById('checkPayment').disabled = false;

      // –ì–µ–Ω–µ—Ä–∏—Ä—É–µ–º QR –∫–æ–¥
      const qrContainer = document.getElementById('system-qr');
      qrContainer.innerHTML = `<img src="https://api.qrserver.com/v1/create-qr-code/?size=200x200&data=${systemAddress}" alt="QR Code" style="max-width: 200px;">`;

      // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –±–µ–π–¥–∂–∏ BscScan
      showTrustBadges(systemAddress);

      // –ü–µ—Ä–µ—Ö–æ–¥–∏–º –∫ —à–∞–≥—É 2
      nextStep();

      showToast('–ê–¥—Ä–µ—Å –¥–ª—è –æ–ø–ª–∞—Ç—ã —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω', 'success');
    }

    // ===== TRUST BADGES =====
    function showTrustBadges(contractAddress) {
      if (!isHexAddressBSC(contractAddress)) {
        return;
      }

      const badgesContainer = document.getElementById('trust-badges');
      const messageEl = document.getElementById('trust-message');

      // –§–æ—Ä–º–∏—Ä—É–µ–º —Å—Å—ã–ª–∫–∏
      document.getElementById('badgeContract').href = `https://bscscan.com/token/${contractAddress}`;
      document.getElementById('badgeRead').href = `https://bscscan.com/token/${contractAddress}#readContract`;
      document.getElementById('badgeWrite').href = `https://bscscan.com/token/${contractAddress}#writeContract`;

      // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –±–µ–π–¥–∂–∏
      badgesContainer.classList.remove('hidden');
      messageEl.classList.add('hidden');
    }

    // ===== CHECK PAYMENT =====
    async function checkPayment() {
      const now = Date.now();
      const timeSinceLastCheck = now - lastPaymentCheck;

      if (timeSinceLastCheck < RATE_LIMIT_MS) {
        const remainingSeconds = Math.ceil((RATE_LIMIT_MS - timeSinceLastCheck) / 1000);
        showToast(`–ü–æ–¥–æ–∂–¥–∏—Ç–µ ${remainingSeconds} —Å–µ–∫ –ø–µ—Ä–µ–¥ —Å–ª–µ–¥—É—é—â–µ–π –ø—Ä–æ–≤–µ—Ä–∫–æ–π`, 'warn');
        return;
      }

      lastPaymentCheck = now;
      const btn = document.getElementById('checkPayment');
      setLoading(btn, true);

      console.info('[pay-check]', {
        time: new Date().toISOString(),
        fromCache: false
      });

      // –°–∏–º—É–ª—è—Ü–∏—è –ø—Ä–æ–≤–µ—Ä–∫–∏ (2 —Å–µ–∫—É–Ω–¥—ã)
      await new Promise(resolve => setTimeout(resolve, 2000));

      setLoading(btn, false);

      // –î–ª—è –¥–µ–º–æ: —Ä–∞–Ω–¥–æ–º–Ω—ã–π —É—Å–ø–µ—Ö
      const success = Math.random() > 0.5;

      if (success) {
        showToast('–û–ø–ª–∞—Ç–∞ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∞!', 'success');
        document.getElementById('step2Next').disabled = false;
        setStepState(2, 'success');
      } else {
        showToast('–û–ø–ª–∞—Ç–∞ –ø–æ–∫–∞ –Ω–µ –Ω–∞–π–¥–µ–Ω–∞. –ü–æ–ø—Ä–æ–±—É–π—Ç–µ –ø–æ–∑–∂–µ.', 'error');
        setStepState(2, 'error');
      }
    }

    // ===== RECHECK PAYMENT =====
    async function recheckPayment() {
      // –ê–Ω–∞–ª–æ–≥–∏—á–Ω–æ checkPayment
      await checkPayment();

      // –ï—Å–ª–∏ —É—Å–ø–µ—à–Ω–æ, —Ä–∞–∑—Ä–µ—à–∞–µ–º –ø–µ—Ä–µ—Ö–æ–¥ –∫ —à–∞–≥—É 4
      document.getElementById('step3Next').disabled = false;
      document.getElementById('paymentStatus').className = 'chip chip--success';
      document.getElementById('paymentStatus').textContent = '–¢—Ä–∞–Ω–∑–∞–∫—Ü–∏—è –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∞ ‚úì';
    }

    // ===== CHART =====
    function refreshChart() {
      if (!chart) return;

      const btn = document.getElementById('refreshChart');
      setLoading(btn, true);

      // –°–∏–º—É–ª—è—Ü–∏—è –∑–∞–≥—Ä—É–∑–∫–∏ –¥–∞–Ω–Ω—ã—Ö
      setTimeout(() => {
        const mockData = generateMockData(50);
        chart.setData(mockData);
        setLoading(btn, false);
        showToast('–ì—Ä–∞—Ñ–∏–∫ –æ–±–Ω–æ–≤–ª—ë–Ω', 'success');
      }, 1000);
    }

    // ===== TECH INFO =====
    function fillTechInfo() {
      // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º —Å–∫–µ–ª–µ—Ç–æ–Ω—ã –ø–æ–∫–∞ –∑–∞–≥—Ä—É–∂–∞–µ–º—Å—è
      setTimeout(() => {
        const browserEl = document.getElementById('tech-browser');
        const langEl = document.getElementById('tech-lang');
        const timezoneEl = document.getElementById('tech-timezone');
        const connectionEl = document.getElementById('tech-connection');

        // –ó–∞–ø–æ–ª–Ω—è–µ–º —Ä–µ–∞–ª—å–Ω—ã–º–∏ –¥–∞–Ω–Ω—ã–º–∏
        browserEl.textContent = navigator.userAgent.split(' ').slice(-2).join(' ');
        hideSkeleton(browserEl);

        langEl.textContent = navigator.language || navigator.userLanguage || 'N/A';
        hideSkeleton(langEl);

        try {
          const tz = Intl.DateTimeFormat().resolvedOptions().timeZone;
          timezoneEl.textContent = tz || 'N/A';
        } catch {
          timezoneEl.textContent = 'N/A';
        }
        hideSkeleton(timezoneEl);

        if (navigator.connection) {
          const conn = navigator.connection;
          connectionEl.textContent = `${conn.effectiveType || 'N/A'} (${conn.downlink || '?'} Mbps)`;
        } else {
          connectionEl.textContent = 'Online';
        }
        hideSkeleton(connectionEl);
      }, 1500);
    }
  </script>
</body>
</html>
