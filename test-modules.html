<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–¢–µ—Å—Ç –∑–∞–≥—Ä—É–∑–∫–∏ –º–æ–¥—É–ª–µ–π</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            padding: 20px;
            background: #1a1a1a;
            color: #fff;
        }
        .test-result {
            margin: 10px 0;
            padding: 10px;
            border-radius: 5px;
        }
        .success {
            background: #0d4f0d;
            color: #0f0;
        }
        .error {
            background: #4f0d0d;
            color: #f00;
        }
        .info {
            background: #0d0d4f;
            color: #88f;
        }
    </style>
</head>
<body>
    <h1>–¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –∑–∞–≥—Ä—É–∑–∫–∏ –º–æ–¥—É–ª–µ–π GENESIS</h1>
    <div id="results"></div>
    
    <script type="module">
        const results = document.getElementById('results');
        
        function addResult(message, type = 'info') {
            const div = document.createElement('div');
            div.className = `test-result ${type}`;
            div.textContent = message;
            results.appendChild(div);
        }
        
        async function testModuleLoading() {
            addResult('üöÄ –ù–∞—á–∏–Ω–∞–µ–º —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ...', 'info');
            
            // –¢–µ—Å—Ç 1: –ü—Ä–æ–≤–µ—Ä–∫–∞ –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç–∏ —Ñ–∞–π–ª–æ–≤ —á–µ—Ä–µ–∑ fetch
            addResult('üìÅ –¢–µ—Å—Ç 1: –ü—Ä–æ–≤–µ—Ä–∫–∞ –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç–∏ —Ñ–∞–π–ª–æ–≤ —á–µ—Ä–µ–∑ fetch', 'info');
            
            const filesToTest = [
                '/modules/dashboard/index.js',
                '/modules/dashboard/dashboard.module.js',
                '/core/bootstrap.js',
                '/core/event-bus.js',
                '/core/router.js'
            ];
            
            for (const file of filesToTest) {
                try {
                    const response = await fetch(file);
                    const contentType = response.headers.get('content-type');
                    
                    if (response.ok) {
                        if (contentType && contentType.includes('javascript')) {
                            addResult(`‚úÖ ${file} - OK (${contentType})`, 'success');
                        } else {
                            addResult(`‚ö†Ô∏è ${file} - –ó–∞–≥—Ä—É–∂–µ–Ω, –Ω–æ –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã–π —Ç–∏–ø: ${contentType}`, 'error');
                            const text = await response.text();
                            if (text.includes('<!DOCTYPE') || text.includes('<html')) {
                                addResult(`   ‚ùå –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç—Å—è HTML –≤–º–µ—Å—Ç–æ JS!`, 'error');
                            }
                        }
                    } else {
                        addResult(`‚ùå ${file} - –û—à–∏–±–∫–∞ ${response.status}`, 'error');
                    }
                } catch (error) {
                    addResult(`‚ùå ${file} - ${error.message}`, 'error');
                }
            }
            
            // –¢–µ—Å—Ç 2: –ü–æ–ø—ã—Ç–∫–∞ –∏–º–ø–æ—Ä—Ç–∞ –º–æ–¥—É–ª–µ–π
            addResult('üì¶ –¢–µ—Å—Ç 2: –ü–æ–ø—ã—Ç–∫–∞ –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–æ–≥–æ –∏–º–ø–æ—Ä—Ç–∞', 'info');
            
            try {
                // –ü—Ä–æ–±—É–µ–º —Ä–∞–∑–Ω—ã–µ –≤–∞—Ä–∏–∞–Ω—Ç—ã –ø—É—Ç–µ–π
                const paths = [
                    '/modules/dashboard/index.js',
                    './modules/dashboard/index.js',
                    '../modules/dashboard/index.js',
                    'modules/dashboard/index.js'
                ];
                
                for (const path of paths) {
                    try {
                        addResult(`üîÑ –ü—Ä–æ–±—É–µ–º –∏–º–ø–æ—Ä—Ç: ${path}`, 'info');
                        const module = await import(path);
                        addResult(`‚úÖ –£—Å–ø–µ—à–Ω–æ –∏–º–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω: ${path}`, 'success');
                        if (module.default) {
                            addResult(`   ‚úÖ –ú–æ–¥—É–ª—å –∏–º–µ–µ—Ç default export`, 'success');
                        }
                        break; // –ï—Å–ª–∏ —É—Å–ø–µ—à–Ω–æ, –ø—Ä–µ–∫—Ä–∞—â–∞–µ–º –ø–æ–ø—ã—Ç–∫–∏
                    } catch (error) {
                        addResult(`   ‚ùå –û—à–∏–±–∫–∞: ${error.message}`, 'error');
                    }
                }
            } catch (error) {
                addResult(`‚ùå –û–±—â–∞—è –æ—à–∏–±–∫–∞ –∏–º–ø–æ—Ä—Ç–∞: ${error.message}`, 'error');
            }
            
            // –¢–µ—Å—Ç 3: –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ç–µ–∫—É—â–µ–≥–æ URL
            addResult('üåê –¢–µ—Å—Ç 3: –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ —Ç–µ–∫—É—â–µ–º —Ä–∞—Å–ø–æ–ª–æ–∂–µ–Ω–∏–∏', 'info');
            addResult(`   URL: ${window.location.href}`, 'info');
            addResult(`   Origin: ${window.location.origin}`, 'info');
            addResult(`   Pathname: ${window.location.pathname}`, 'info');
            
            // –¢–µ—Å—Ç 4: –ü—Ä–æ–≤–µ—Ä–∫–∞ –±–∞–∑–æ–≤–æ–≥–æ –ø—É—Ç–∏ –¥–ª—è –∏–º–ø–æ—Ä—Ç–æ–≤
            addResult('üîó –¢–µ—Å—Ç 4: –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –±–∞–∑–æ–≤–æ–≥–æ –ø—É—Ç–∏', 'info');
            const base = document.querySelector('base');
            if (base) {
                addResult(`   Base href: ${base.href}`, 'info');
            } else {
                addResult(`   Base —Ç–µ–≥ –Ω–µ –Ω–∞–π–¥–µ–Ω`, 'info');
            }
            
            // –ò—Ç–æ–≥
            addResult('‚úÖ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –∑–∞–≤–µ—Ä—à–µ–Ω–æ!', 'info');
        }
        
        // –ó–∞–ø—É—Å–∫–∞–µ–º —Ç–µ—Å—Ç
        testModuleLoading();
    </script>
</body>
</html>
