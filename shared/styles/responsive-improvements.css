/**
 * GENESIS Platform - Responsive Design Improvements
 * Исправления адаптивности для мобильных и десктопных устройств
 * Версия: 1.0.0
 */

/* ============================================
   ГЛОБАЛЬНЫЕ УЛУЧШЕНИЯ АДАПТИВНОСТИ
============================================ */

/* Viewport базовые настройки */
:root {
    /* Минимальные отступы для мобильных (16px - стандарт Google Material) */
    --mobile-padding-min: 16px;

    /* Touch target минимальный размер (44x44px - Apple HIG, 48x48px - Material Design) */
    --touch-target-min: 44px;
    --touch-target-optimal: 48px;

    /* Max-width для читаемости форм и контента */
    --form-max-width: 600px;
    --content-max-width: 800px;

    /* Адаптивная типографика */
    --font-size-fluid-sm: clamp(0.875rem, 2vw, 1rem);
    --font-size-fluid-base: clamp(1rem, 2.5vw, 1.125rem);
    --font-size-fluid-lg: clamp(1.125rem, 3vw, 1.25rem);
    --font-size-fluid-xl: clamp(1.25rem, 3.5vw, 1.5rem);
    --font-size-fluid-2xl: clamp(1.5rem, 4vw, 2rem);
    --font-size-fluid-3xl: clamp(2rem, 5vw, 2.5rem);
}

/* ============================================
   ПРОБЛЕМА #1: РЕСПОНСИВНЫЙ ДИЗАЙН ФОРМ
============================================ */

/* Ограничение ширины форм на десктопе для лучшей читаемости */
.auth-card,
.auth-form,
.genesis-auth-card {
    max-width: var(--form-max-width);
    width: 100%;
    margin-left: auto;
    margin-right: auto;
}

/* Форма авторизации - адаптация для мобильных */
@media (max-width: 768px) {
    .auth-card,
    .genesis-auth-card {
        /* Минимум 16px отступы по бокам */
        margin: 0 var(--mobile-padding-min);
        width: calc(100% - calc(var(--mobile-padding-min) * 2));
        padding: 1.5rem 1rem;
    }

    /* Поля ввода адреса кошелька */
    .form-control,
    .genesis-form-input,
    input[type="text"],
    input[type="email"] {
        width: 100%;
        font-size: 16px; /* Предотвращает zoom на iOS */
        padding: 14px 16px;
        box-sizing: border-box;
        word-break: break-all;
    }

    /* Подсказки и хинты */
    .input-hint,
    .form-hint {
        font-size: clamp(0.7rem, 2vw, 0.85rem);
        word-wrap: break-word;
        overflow-wrap: break-word;
    }
}

/* Малые мобильные устройства */
@media (max-width: 480px) {
    .form-control,
    .genesis-form-input {
        padding: 12px 14px;
        font-size: 14px;
    }
}

/* ============================================
   ПРОБЛЕМА #2: УВЕЛИЧЕНИЕ РАЗМЕРА КНОПОК КОПИРОВАНИЯ
============================================ */

/* Кнопки копирования - минимальный размер для touch устройств */
.copy-btn,
.genesis-btn-copy,
.btn-copy,
button[aria-label*="Копировать"],
button[aria-label*="Copy"] {
    /* Минимальный размер 44x44px (Apple HIG) */
    min-width: var(--touch-target-min);
    min-height: var(--touch-target-min);
    padding: 10px 14px;

    /* Оптимальный размер 48x48px (Material Design) */
    display: inline-flex;
    align-items: center;
    justify-content: center;
    gap: 0.5rem;

    /* Увеличенная область касания для удобства */
    position: relative;
}

/* Псевдо-элемент для увеличения области касания */
.copy-btn::before,
.genesis-btn-copy::before,
.btn-copy::before {
    content: '';
    position: absolute;
    top: -8px;
    right: -8px;
    bottom: -8px;
    left: -8px;
    z-index: -1;
}

/* Touch устройства - еще больше места для нажатия */
@media (hover: none) and (pointer: coarse) {
    .copy-btn,
    .genesis-btn-copy,
    .btn-copy {
        min-width: var(--touch-target-optimal);
        min-height: var(--touch-target-optimal);
        padding: 12px 16px;
        font-size: 1rem;
    }

    /* Иконки внутри кнопок копирования */
    .copy-icon,
    .copy-btn svg,
    .genesis-btn-copy svg {
        min-width: 20px;
        min-height: 20px;
        font-size: 1.2rem;
    }
}

/* Мобильные - кнопка на всю ширину для лучшей доступности */
@media (max-width: 768px) {
    .system-address-container,
    .genesis-address-container {
        flex-direction: column;
        gap: 0.75rem;
    }

    .copy-btn,
    .genesis-btn-copy {
        width: 100%;
        justify-content: center;
        min-height: var(--touch-target-optimal);
    }
}

/* ============================================
   ПРОБЛЕМА #3: ЧИТАЕМОСТЬ АДРЕСОВ КОШЕЛЬКОВ
============================================ */

/* Адреса кошельков - улучшенная читаемость */
.system-address,
.genesis-address,
.wallet-address,
.address-display {
    /* Полная ширина контейнера */
    width: 100%;
    box-sizing: border-box;

    /* Адаптивный размер шрифта */
    font-size: clamp(0.75rem, 2vw, 0.875rem);
    font-family: 'Courier New', monospace;

    /* Перенос длинных адресов */
    word-break: break-all;
    overflow-wrap: break-word;
    white-space: normal;

    /* Отступы */
    padding: 12px 14px;
    line-height: 1.5;
}

/* Десктоп - показываем полный адрес с моноширинным шрифтом */
@media (min-width: 769px) {
    .system-address,
    .genesis-address,
    .wallet-address {
        font-size: 0.875rem;
        letter-spacing: 0.025em;
    }
}

/* Мобильные - сокращение адреса с ellipsis в середине */
@media (max-width: 768px) {
    /* Компактное отображение адреса */
    .address-compact {
        display: inline-block;
        max-width: 100%;
        overflow: hidden;
        text-overflow: ellipsis;
        white-space: nowrap;
    }

    /* Альтернатива - показываем начало и конец адреса */
    .address-truncated {
        display: flex;
        align-items: center;
        gap: 0.25rem;
        font-size: 0.8rem;
    }

    .address-start,
    .address-end {
        font-family: monospace;
    }

    .address-dots {
        opacity: 0.5;
        padding: 0 0.25rem;
    }
}

/* Улучшение контраста для лучшей читаемости */
.system-address,
.genesis-address,
.wallet-address {
    background: var(--bg-tertiary, #2a2a3e);
    border: 1px solid var(--border-color, #333344);
    border-radius: 8px;
    color: var(--text-primary, #ffffff);
}

/* Активное состояние при выделении */
.system-address:focus,
.genesis-address:focus,
.wallet-address:focus {
    outline: 2px solid var(--primary-color, #ff6b35);
    outline-offset: 2px;
}

/* ============================================
   ПРОБЛЕМА #4: ОПТИМИЗАЦИЯ ОТСТУПОВ
============================================ */

/* Контейнеры - минимум 16px отступы на мобильных */
@media (max-width: 768px) {
    .genesis-container,
    .genesis-container-wide,
    .genesis-container-narrow,
    .genesis-container-full,
    .auth-module-container,
    .main-content {
        padding-left: var(--mobile-padding-min);
        padding-right: var(--mobile-padding-min);
    }

    /* Секции контента */
    .genesis-section,
    .auth-section,
    .payment-info {
        padding-left: var(--mobile-padding-min);
        padding-right: var(--mobile-padding-min);
    }

    /* Карточки */
    .genesis-info-card,
    .auth-card,
    .payment-card {
        margin-left: var(--mobile-padding-min);
        margin-right: var(--mobile-padding-min);
    }
}

/* Малые мобильные - чуть меньше отступов (минимум 12px) */
@media (max-width: 480px) {
    .genesis-container,
    .genesis-container-wide,
    .genesis-container-narrow {
        padding-left: 12px;
        padding-right: 12px;
    }
}

/* ============================================
   ПРОБЛЕМА #5: ОГРАНИЧЕНИЕ ШИРИНЫ НА ДЕСКТОПЕ
============================================ */

/* Формы и контент - max-width для читаемости */
@media (min-width: 769px) {
    /* Формы авторизации */
    .auth-module-container .auth-card,
    .genesis-auth-card {
        max-width: var(--form-max-width);
    }

    /* Текстовый контент */
    .text-content,
    .article-content,
    .instruction-content {
        max-width: var(--content-max-width);
        margin-left: auto;
        margin-right: auto;
    }

    /* Узкие контейнеры для лучшей читаемости */
    .genesis-container-narrow {
        max-width: var(--content-max-width);
    }
}

/* ============================================
   ПРОБЛЕМА #6: АДАПТИВНЫЕ БРЕЙКПОИНТЫ
============================================ */

/* Малые мобильные устройства (<480px) */
@media (max-width: 480px) {
    :root {
        font-size: 14px;
    }

    /* Компактные заголовки */
    h1, .h1 { font-size: clamp(1.75rem, 6vw, 2rem); }
    h2, .h2 { font-size: clamp(1.5rem, 5vw, 1.75rem); }
    h3, .h3 { font-size: clamp(1.25rem, 4vw, 1.5rem); }
}

/* Мобильные устройства (480px - 768px) */
@media (min-width: 481px) and (max-width: 768px) {
    :root {
        font-size: 15px;
    }

    /* Сетки - 1 колонка */
    .genesis-info-grid,
    .stats-grid {
        grid-template-columns: 1fr;
        gap: 1rem;
    }
}

/* Планшеты (768px - 1024px) */
@media (min-width: 769px) and (max-width: 1024px) {
    :root {
        font-size: 16px;
    }

    /* Сетки - 2 колонки */
    .genesis-info-grid,
    .stats-grid {
        grid-template-columns: repeat(2, 1fr);
        gap: 1.5rem;
    }

    /* Контейнеры */
    .genesis-container {
        max-width: 960px;
        padding: 0 1.5rem;
    }
}

/* Десктоп (1024px - 1440px) */
@media (min-width: 1025px) and (max-width: 1440px) {
    :root {
        font-size: 16px;
    }

    /* Сетки - 3-4 колонки */
    .genesis-info-grid,
    .stats-grid {
        grid-template-columns: repeat(3, 1fr);
        gap: 2rem;
    }

    /* Контейнеры */
    .genesis-container {
        max-width: 1200px;
    }

    .genesis-container-wide {
        max-width: 1400px;
    }
}

/* Широкие экраны (>1440px) */
@media (min-width: 1441px) {
    /* Сетки - 4 колонки */
    .genesis-info-grid,
    .stats-grid {
        grid-template-columns: repeat(4, 1fr);
        gap: 2rem;
    }

    /* Ограничение максимальной ширины */
    .genesis-container-wide {
        max-width: 1600px;
    }
}

/* ============================================
   ПРОБЛЕМА #7: ПЛАВАЮЩАЯ КНОПКА ТЕРМИНАЛА
============================================ */

/* Кнопка "Открыть Терминал" - улучшенное позиционирование */
.terminal-open-btn,
.floating-terminal-btn,
button[aria-label*="Терминал"],
button[aria-label*="Terminal"] {
    position: fixed;
    bottom: 24px;
    right: 24px;
    z-index: var(--z-fixed, 300);

    /* Минимальный размер для touch */
    min-width: var(--touch-target-optimal);
    min-height: var(--touch-target-optimal);

    /* Предотвращение перекрытия контента */
    pointer-events: auto;
}

/* Мобильные - кнопка не должна перекрывать контент */
@media (max-width: 768px) {
    .terminal-open-btn,
    .floating-terminal-btn {
        /* Уменьшаем размер на мобильных */
        bottom: 16px;
        right: 16px;

        /* Safe area для iOS */
        bottom: calc(16px + env(safe-area-inset-bottom));
        right: calc(16px + env(safe-area-inset-right));

        /* Более компактная кнопка */
        min-width: 56px;
        min-height: 56px;
        border-radius: 50%;

        /* Тень для видимости */
        box-shadow: 0 4px 12px rgba(0, 0, 0, 0.5);
    }

    /* Скрываем текст на мобильных, оставляем только иконку */
    .terminal-open-btn .btn-text,
    .floating-terminal-btn .btn-text {
        display: none;
    }

    /* Иконка центрируется */
    .terminal-open-btn .btn-icon,
    .floating-terminal-btn .btn-icon {
        margin: 0;
        font-size: 1.5rem;
    }
}

/* Защита от перекрытия при скролле */
body:has(.terminal-open-btn),
body:has(.floating-terminal-btn) {
    /* Добавляем отступ снизу для контента */
    padding-bottom: 80px;
}

@media (max-width: 768px) {
    body:has(.terminal-open-btn),
    body:has(.floating-terminal-btn) {
        padding-bottom: 88px;
    }
}

/* ============================================
   ПРОБЛЕМА #8: АДАПТИВНАЯ ТИПОГРАФИКА
============================================ */

/* Используем относительные единицы и clamp() для плавной адаптации */

/* Базовые размеры текста */
body {
    font-size: clamp(14px, 2vw, 16px);
    line-height: 1.6;
}

/* Заголовки с плавной адаптацией */
h1, .h1 {
    font-size: clamp(2rem, 5vw + 1rem, 2.5rem);
    line-height: 1.2;
    margin-bottom: clamp(1rem, 3vw, 1.5rem);
}

h2, .h2 {
    font-size: clamp(1.5rem, 4vw + 0.5rem, 2rem);
    line-height: 1.3;
    margin-bottom: clamp(0.75rem, 2vw, 1.25rem);
}

h3, .h3 {
    font-size: clamp(1.25rem, 3vw + 0.25rem, 1.5rem);
    line-height: 1.4;
    margin-bottom: clamp(0.5rem, 1.5vw, 1rem);
}

h4, .h4 {
    font-size: clamp(1.125rem, 2.5vw, 1.25rem);
    line-height: 1.5;
}

/* Параграфы */
p {
    font-size: clamp(0.875rem, 2vw, 1rem);
    line-height: 1.6;
    margin-bottom: 1em;
}

/* Малый текст */
small, .text-sm {
    font-size: clamp(0.75rem, 1.5vw, 0.875rem);
}

/* Кнопки с адаптивным размером */
.btn, .genesis-btn {
    font-size: clamp(0.875rem, 2vw, 1rem);
    padding: clamp(0.75rem, 2vw, 1rem) clamp(1rem, 3vw, 1.5rem);
    line-height: 1.5;
}

/* Инпуты с адаптивным размером */
.form-control,
.genesis-form-input,
input,
textarea,
select {
    font-size: clamp(14px, 2vw, 16px); /* Минимум 14px для предотвращения zoom */
    padding: clamp(0.75rem, 2vw, 1rem);
    line-height: 1.5;
}

/* Лейблы */
.form-label,
.genesis-form-label,
label {
    font-size: clamp(0.875rem, 2vw, 0.95rem);
    font-weight: 500;
}

/* ============================================
   УЛУЧШЕНИЯ ДОСТУПНОСТИ
============================================ */

/* Focus states - видимые на всех устройствах */
*:focus-visible {
    outline: 2px solid var(--primary-color, #ff6b35);
    outline-offset: 2px;
    border-radius: 4px;
}

/* Скрытие outline для мыши, показ для клавиатуры */
*:focus:not(:focus-visible) {
    outline: none;
}

/* Skip to content для клавиатурной навигации */
.skip-to-content {
    position: absolute;
    top: -40px;
    left: 0;
    background: var(--primary-color);
    color: white;
    padding: 0.5rem 1rem;
    z-index: 1000;
    text-decoration: none;
    border-radius: 0 0 4px 0;
}

.skip-to-content:focus {
    top: 0;
}

/* ============================================
   PRINT СТИЛИ
============================================ */

@media print {
    /* Скрываем навигацию и кнопки при печати */
    .terminal-open-btn,
    .floating-terminal-btn,
    .genesis-header,
    .genesis-sidebar,
    nav,
    button {
        display: none !important;
    }

    /* Контент на всю ширину */
    .genesis-container,
    .genesis-container-wide {
        max-width: 100%;
        padding: 0;
    }

    /* Черно-белая печать */
    body {
        background: white;
        color: black;
    }

    /* Избегаем разрывов страниц */
    .genesis-info-card,
    .stats-card,
    .payment-info {
        break-inside: avoid;
    }
}

/* ============================================
   REDUCED MOTION
============================================ */

/* Уважаем предпочтения пользователя */
@media (prefers-reduced-motion: reduce) {
    *,
    *::before,
    *::after {
        animation-duration: 0.01ms !important;
        animation-iteration-count: 1 !important;
        transition-duration: 0.01ms !important;
        scroll-behavior: auto !important;
    }
}

/* ============================================
   HIGH CONTRAST MODE
============================================ */

@media (prefers-contrast: high) {
    /* Увеличенный контраст для accessibility */
    .system-address,
    .genesis-address,
    .wallet-address {
        border-width: 2px;
    }

    .copy-btn,
    .genesis-btn-copy {
        border: 2px solid currentColor;
    }

    *:focus-visible {
        outline-width: 3px;
    }
}
