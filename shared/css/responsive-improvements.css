/**
 * GENESIS 1.1 - Comprehensive Responsive Design Improvements
 * Точечные фиксы для мобильных и десктопных экранов
 *
 * Основные улучшения:
 * - Рамки читаемости для текста (max-width)
 * - Безопасные зоны touch-устройств (44-48px)
 * - Моношрифт и переносы для адресов/кодов
 * - Адаптивная типографика через clamp()
 * - Двух-/трёхколоночные сетки для технических данных
 * - Safe area для iOS
 * - QR-кнопки в колонку на узких экранах
 */

/* ============================================
   1. РАМКИ ЧИТАЕМОСТИ + МОБИЛЬНЫЕ ПОЛЯ
   ============================================ */

:root {
    /* Safe area для iOS */
    --safe-area-inset-top: env(safe-area-inset-top, 0);
    --safe-area-inset-right: env(safe-area-inset-right, 0);
    --safe-area-inset-bottom: env(safe-area-inset-bottom, 0);
    --safe-area-inset-left: env(safe-area-inset-left, 0);
}

/* Основные контейнеры - ограничение ширины для читаемости */
.main,
.content,
.container,
.module-content,
.auth-card,
.device-content,
.info-card {
    margin-inline: auto;
    padding-inline: clamp(12px, 4vw, 24px);
    max-width: 820px; /* текстовые секции */
}

/* Формы - более узкие для удобства */
form,
.auth-form,
.form-container,
.genesis-form {
    max-width: 600px;
    margin-inline: auto;
}

/* Безопасная нижняя кромка под iOS */
body {
    padding-bottom: max(16px, var(--safe-area-inset-bottom));
    padding-top: max(0px, var(--safe-area-inset-top));
    padding-left: max(0px, var(--safe-area-inset-left));
    padding-right: max(0px, var(--safe-area-inset-right));
}

/* ============================================
   2. ДЛИННЫЕ АДРЕСА И КОДОВЫЕ СТРОКИ
   ============================================ */

/* Моношрифт + переносы для всех адресов, хешей, кодов */
.code,
code,
.address,
.hash,
.system-address,
.wallet-address,
.contract-address,
.transaction-hash,
.address-display-box,
.test-address,
pre {
    font-family: ui-monospace, 'SF Mono', Monaco, 'Cascadia Code', 'Roboto Mono',
                 Menlo, Consolas, 'DejaVu Sans Mono', monospace;
    overflow-wrap: anywhere;
    word-break: break-all;
    font-size: clamp(12px, 2.2vw, 14px);
    line-height: 1.5;
    background: rgba(255, 255, 255, 0.05);
    padding: 4px 8px;
    border-radius: 4px;
}

/* Для длинных адресов в списках */
.info-value code,
.info-item code,
.plex-info-item code {
    display: inline-block;
    max-width: 100%;
}

/* ============================================
   3. КНОПКИ - БЕЗОПАСНАЯ ЗОНА И ВЫСОТА
   ============================================ */

/* Все кнопки - минимум 44px для touch-устройств */
button,
.btn,
.copy-btn,
.auth-button,
.genesis-btn,
a.btn,
input[type="submit"],
input[type="button"] {
    min-height: 44px;
    min-width: 44px;
    padding: 12px 16px;
    touch-action: manipulation;
    cursor: pointer;
    font-size: clamp(14px, 2vw, 16px);
    border-radius: 8px;
    transition: all 0.2s ease;
}

/* Увеличенные кнопки для важных действий */
.btn-primary,
.btn-large,
.btn-full {
    min-height: 48px;
    padding: 14px 24px;
    font-size: clamp(15px, 2.2vw, 17px);
}

/* Кнопки копирования - всегда квадратные и удобные */
.copy-btn,
.btn-icon {
    min-width: 44px;
    min-height: 44px;
    padding: 10px;
    display: inline-flex;
    align-items: center;
    justify-content: center;
}

/* ============================================
   4. QR-КНОПКИ - КОЛОНКОЙ НА УЗКИХ ЭКРАНАХ
   ============================================ */

/* Контейнер для QR-кнопок */
.qr-actions,
.qr-buttons,
.qr-controls,
.payment-qr-section .button-group {
    display: flex;
    gap: 12px;
    flex-wrap: wrap;
}

@media (max-width: 480px) {
    .qr-actions,
    .qr-buttons,
    .qr-controls,
    .payment-qr-section .button-group {
        display: grid;
        grid-template-columns: 1fr;
        gap: 10px;
        grid-auto-rows: minmax(44px, auto);
    }

    .qr-actions button,
    .qr-buttons button,
    .qr-controls button {
        width: 100%;
        justify-content: center;
    }
}

/* ============================================
   5. ТЕХНИЧЕСКИЕ СПИСКИ - СЕТКА НА ДЕСКТОПЕ
   ============================================ */

/* Ключ-значение списки */
.kv-list,
.info-list,
.device-info-list,
.tech-specs,
.stats-list,
.params-list {
    display: grid;
    grid-template-columns: 1fr;
    gap: 12px;
}

/* На планшетах и десктопе - две колонки */
@media (min-width: 768px) {
    .kv-list,
    .info-list,
    .device-info-list,
    .tech-specs,
    .stats-list,
    .params-list {
        grid-template-columns: repeat(2, 1fr);
        gap: 12px 24px;
        max-width: 1000px;
    }
}

/* На больших десктопах - три колонки для очень плотных данных */
@media (min-width: 1280px) {
    .tech-specs.dense,
    .stats-list.dense {
        grid-template-columns: repeat(3, 1fr);
    }
}

/* Элементы списка */
.info-item,
.kv-item,
.stat-item {
    display: flex;
    justify-content: space-between;
    align-items: flex-start;
    padding: clamp(8px, 2vw, 10px);
    font-size: clamp(0.85rem, 2vw, 0.95rem);
    background: rgba(255, 255, 255, 0.03);
    border-radius: 6px;
    gap: 12px;
}

.info-label,
.kv-key {
    font-weight: 600;
    color: var(--text-secondary, #999);
    flex-shrink: 0;
    min-width: 120px;
}

.info-value,
.kv-value {
    text-align: right;
    color: var(--text-primary, #fff);
    overflow-wrap: anywhere;
    word-break: break-word;
}

/* ============================================
   6. ТИПОГРАФИКА ПОД ЛЮБЫЕ ШИРИНЫ
   ============================================ */

h1, .h1, .module-title {
    font-size: clamp(28px, 5vw + 0.5rem, 40px);
    line-height: 1.15;
    margin-bottom: clamp(16px, 3vh, 24px);
}

h2, .h2, .auth-title {
    font-size: clamp(22px, 4vw + 0.3rem, 28px);
    line-height: 1.2;
    margin-bottom: clamp(12px, 2.5vh, 20px);
}

h3, .h3, .section-title {
    font-size: clamp(18px, 3vw + 0.2rem, 24px);
    line-height: 1.3;
    margin-bottom: clamp(10px, 2vh, 16px);
}

h4, .h4 {
    font-size: clamp(16px, 2.5vw, 20px);
    line-height: 1.4;
    margin-bottom: clamp(8px, 1.5vh, 12px);
}

p, .text-body, .module-subtitle, .auth-subtitle {
    font-size: clamp(15px, 1.7vw, 17px);
    line-height: 1.6;
    margin-bottom: clamp(12px, 2vh, 16px);
}

small, .text-small, .input-hint {
    font-size: clamp(13px, 1.5vw, 15px);
    line-height: 1.5;
}

/* ============================================
   7. АВТОРИЗАЦИЯ - ШАГИ В КАРТОЧКАХ
   ============================================ */

/* Контейнер шагов */
.payment-steps,
.auth-steps,
.instruction-steps {
    display: flex;
    flex-direction: column;
    gap: clamp(16px, 3vw, 24px);
    margin: clamp(20px, 4vw, 30px) 0;
}

/* Каждый шаг - отдельная карточка */
.step,
.auth-step,
.instruction-step {
    display: flex;
    gap: clamp(12px, 2vw, 16px);
    padding: clamp(16px, 3vw, 20px);
    background: rgba(255, 255, 255, 0.04);
    border: 1px solid rgba(255, 255, 255, 0.1);
    border-radius: clamp(8px, 2vw, 12px);
    transition: all 0.2s ease;
}

.step:hover,
.auth-step:hover,
.instruction-step:hover {
    background: rgba(255, 255, 255, 0.06);
    border-color: rgba(255, 255, 255, 0.2);
}

/* Номер шага */
.step-number {
    flex-shrink: 0;
    width: clamp(32px, 6vw, 40px);
    height: clamp(32px, 6vw, 40px);
    display: flex;
    align-items: center;
    justify-content: center;
    background: var(--gradient-primary, linear-gradient(135deg, #667eea 0%, #764ba2 100%));
    color: white;
    font-weight: 700;
    font-size: clamp(14px, 2.5vw, 18px);
    border-radius: 50%;
}

.step-content {
    flex: 1;
    min-width: 0;
}

.step-content h4 {
    margin-top: 0;
    margin-bottom: 8px;
}

.step-content p {
    margin-bottom: 0;
    color: var(--text-secondary, #999);
}

/* ============================================
   8. МОБИЛЬНЫЕ ФИКСЫ (<480px)
   ============================================ */

@media (max-width: 480px) {
    /* Кнопки на всю ширину */
    .genesis-buttons-container,
    .button-group,
    .auth-footer .footer-links {
        flex-direction: column;
        gap: 12px;
    }

    .genesis-btn,
    .btn,
    .auth-button {
        width: 100%;
        padding: 14px 20px;
    }

    /* Адреса - сокращение через JS (data-address атрибут) */
    .system-address-container,
    .address-container {
        display: flex;
        gap: 8px;
        align-items: center;
        flex-wrap: wrap;
    }

    /* Формы - предотвращаем zoom на iOS */
    .genesis-form-input,
    .form-control,
    input[type="text"],
    input[type="email"],
    input[type="number"],
    textarea {
        font-size: 16px !important; /* Предотвращает автозум на iOS */
        max-width: 100%;
    }

    /* Модальные окна и карточки */
    .auth-card,
    .modal,
    .info-card {
        margin: 12px;
        max-width: calc(100vw - 24px);
    }

    /* Вкладки - прокручиваются горизонтально */
    .device-tabs,
    .tabs-container {
        overflow-x: auto;
        -webkit-overflow-scrolling: touch;
        scrollbar-width: none;
    }

    .device-tabs::-webkit-scrollbar,
    .tabs-container::-webkit-scrollbar {
        display: none;
    }

    .tab-btn {
        flex-shrink: 0;
        min-width: 100px;
    }
}

/* ============================================
   9. ПЛАНШЕТЫ (768px - 1023px)
   ============================================ */

@media (min-width: 768px) and (max-width: 1023px) {
    /* Контейнеры немного шире */
    .main,
    .content,
    .container {
        max-width: 720px;
    }

    /* Кнопки - можно размещать рядом */
    .button-group {
        flex-direction: row;
        justify-content: center;
        flex-wrap: wrap;
    }
}

/* ============================================
   10. ДЕСКТОП (1024px+)
   ============================================ */

@media (min-width: 1024px) {
    /* Максимальная ширина для текста */
    .main,
    .content,
    .container {
        max-width: 820px;
    }

    /* Технические списки - две колонки */
    .kv-list,
    .info-list,
    .device-info-list {
        grid-template-columns: repeat(2, 1fr);
        gap: 12px 24px;
        max-width: 1000px;
    }

    /* Кнопки в строку */
    .button-group {
        flex-direction: row;
        justify-content: flex-start;
        gap: 16px;
    }
}

/* ============================================
   11. ШИРОКИЕ ЭКРАНЫ (1440px+)
   ============================================ */

@media (min-width: 1440px) {
    /* Технические списки - три колонки для плотных данных */
    .tech-specs,
    .stats-list {
        grid-template-columns: repeat(3, 1fr);
        gap: 16px 32px;
    }

    /* Увеличиваем максимальную ширину контента */
    .main,
    .content,
    .container {
        max-width: 1000px;
    }
}

/* ============================================
   12. TOUCH УСТРОЙСТВА (hover: none)
   ============================================ */

@media (hover: none) and (pointer: coarse) {
    /* Увеличиваем области касания */
    button,
    .btn,
    a,
    .tab-btn,
    .copy-btn {
        min-height: 48px; /* Немного больше для пальцев */
        min-width: 48px;
    }

    /* Отключаем hover эффекты */
    .step:hover,
    .info-card:hover,
    .btn:hover {
        transform: none;
        box-shadow: none;
    }

    /* Упрощаем анимации для производительности */
    * {
        animation-duration: 0.2s !important;
        transition-duration: 0.2s !important;
    }
}

/* ============================================
   13. LANDSCAPE НА МОБИЛКАХ
   ============================================ */

@media (max-width: 768px) and (orientation: landscape) {
    /* Уменьшаем вертикальные отступы */
    .main,
    .content {
        padding-block: clamp(12px, 2vh, 20px);
    }

    /* Компактные заголовки */
    h1, .h1 {
        font-size: clamp(24px, 4vw, 32px);
    }

    h2, .h2 {
        font-size: clamp(20px, 3vw, 24px);
    }
}

/* ============================================
   14. UTILITY КЛАССЫ ДЛЯ АДАПТИВНОСТИ
   ============================================ */

/* Скрыть на мобилках */
@media (max-width: 767px) {
    .hide-mobile {
        display: none !important;
    }
}

/* Скрыть на десктопе */
@media (min-width: 768px) {
    .hide-desktop {
        display: none !important;
    }
}

/* Показывать только на мобилках */
.show-mobile {
    display: none !important;
}

@media (max-width: 767px) {
    .show-mobile {
        display: block !important;
    }
}

/* Полная ширина на мобилках */
@media (max-width: 767px) {
    .full-width-mobile {
        width: 100% !important;
        max-width: 100% !important;
    }
}

/* ============================================
   15. ACCESSIBILITY УЛУЧШЕНИЯ
   ============================================ */

/* Увеличенный фокус для клавиатурной навигации */
*:focus-visible {
    outline: 2px solid var(--accent-primary, #667eea);
    outline-offset: 2px;
    border-radius: 4px;
}

/* Пропускаем фокус для мыши */
*:focus:not(:focus-visible) {
    outline: none;
}

/* Улучшенная читаемость для длинного текста */
p, li, .text-content {
    max-width: 70ch; /* Оптимальная ширина строки */
}

/* ============================================
   16. PRINT СТИЛИ
   ============================================ */

@media print {
    /* Скрываем интерактивные элементы при печати */
    .btn,
    button,
    .qr-actions,
    .auth-footer {
        display: none !important;
    }

    /* Убираем фоны для экономии чернил */
    body {
        background: white !important;
        color: black !important;
    }

    .step,
    .info-card,
    .info-item {
        background: white !important;
        border: 1px solid #ccc !important;
    }
}
